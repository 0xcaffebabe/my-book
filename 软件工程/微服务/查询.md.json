{"content":"# 查询\n\n## API组合模式\n\n> 让拥有数据的服务的客户端调用服务，并组件服务返回的查询结果\n\n![屏幕截图 2021-01-26 150338](/assets/屏幕截图%202021-01-26%20150338.png)\n\n问题：\n\n1. 选择谁为组合器\n  - 客户端\n  - 网关\n  - 实现为独立的服务\n2. 如何在组合器编写聚合逻辑\n\n这种方式好处是简单直观。弊端：\n\n- 带来了额外的开销\n- 可用性有降低的风险\n- 查询缺乏数据一致性\n\n## CQRS模式\n\n维护一个或者多个识图数据库，进而实现查询。\n\n![屏幕截图 2021-01-26 154520](/assets/屏幕截图%202021-01-26%20154520.png)\n\n好处与弊端：\n\n- 高效实现多个服务的多种类型查询\n- 支持事件溯源技术\n- 隔离了问题：领域模型不必同时处理命令和查询\n\n- **架构更加复杂**\n- **数据有一定的延迟**\n\n### CQRS视图设计\n\n- 选择合适的数据库\n  - SQL or NoSQL\n- 数据访问模块\n  - 并发处理\n  - 幂等处理\n- 更新视图\n  - 归档\n  - 快照\n","commitList":[{"date":"2021-10-08T12:45:10+08:00","author":"cjiping","message":"doc开发期 构建期调整","hash":"704efe7455b7fb2fbd81ec60099191ff982e639a"},{"date":"2021-10-07T19:38:58+08:00","author":"My","message":"init","hash":"4e0456332231ba0523aa526415f9982377358870"}],"hasMoreCommit":false,"totalCommits":0}