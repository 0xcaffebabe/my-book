{"content":"\n\n# Lucene实现全文检索的流程\n\n![](https://img-blog.csdnimg.cn/20190322170318574.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3phaG5namlhbGlhbmc=,size_16,color_FFFFFF,t_70)\n\n# 创建索引库\n\n```java\n        // 创建directory指定索引存放位置\n        Directory directory = FSDirectory.open(new File(\"./index\").toPath());\n        IndexWriter indexWriter = new IndexWriter(directory,new IndexWriterConfig());\n\n        File dir = new File(\"./res\");\n        File[] files = dir.listFiles();\n\n        assert files != null;\n        // 遍历文件\n        for (File file : files) {\n            String fileName = file.getName();\n            String filePath = file.getPath();\n            String content = FileUtils.readFileToString(file, \"utf8\");\n            long fileSize = FileUtils.sizeOf(file);\n            \n            // 根据文件内容生成成员\n            Field fieldName = new TextField(\"name\",fileName, Field.Store.YES);\n            Field fieldPath = new TextField(\"path\",filePath,Field.Store.YES);\n            Field fieldContent = new TextField(\"content\",content,Field.Store.YES);\n            Field fieldSize = new TextField(\"size\", String.valueOf(fileSize),Field.Store.YES);\n\n            // 将成员添加到文档中\n            Document document = new Document();\n            document.add(fieldName);\n            document.add(fieldPath);\n            document.add(fieldContent);\n            document.add(fieldSize);\n\n            // 将文档写入索引库\n            indexWriter.addDocument(document);\n        }\n        indexWriter.close();\n```\n\n# 搜索\n\n```java\n        // 创建directory指定索引存放位置\n        Directory directory = FSDirectory.open(new File(\"./index\").toPath());\n\n        IndexReader indexReader = DirectoryReader.open(directory);\n        IndexSearcher indexSearcher = new IndexSearcher(indexReader);\n\n        Query query = new TermQuery(new Term(\"content\",\"spring\"));\n        TopDocs docs = indexSearcher.search(query, 10);\n\n        System.out.println(\"总记录数:\"+docs.totalHits);\n        ScoreDoc[] scoreDocs = docs.scoreDocs;\n        for (ScoreDoc scoreDoc : scoreDocs) {\n            int id = scoreDoc.doc;\n            Document document = indexSearcher.doc(id);\n            System.out.println(document.get(\"name\"));\n            System.out.println(document.get(\"path\"));\n            System.out.println(document.get(\"size\"));\n//            System.out.println(document.get(\"content\"));\n            System.out.println(\"--------------\");\n        }\n        indexReader.close();\n```\n\n# 分析\n\n```java\n        Analyzer analyzer = new StandardAnalyzer();\n\n        TokenStream tokenStream = analyzer.tokenStream(\"\", \"Learn how to create a web page with Spring MVC.\");\n\n        CharTermAttribute charTermAttribute = tokenStream.addAttribute(CharTermAttribute.class);\n\n        tokenStream.reset();\n\n        while (tokenStream.incrementToken()){\n            System.out.println(charTermAttribute.toString());\n        }\n```\n\n## 使用别的分析器\n\n```java\nAnalyzer analyzer = new IKAnalyzer();\n```\n\n# 维护\n\n![批注 2019-09-02 211421](/assets/批注%202019-09-02%20211421.png)\n\n## 删除\n\n```java\n        Directory directory = FSDirectory.open(new File(\"./index\").toPath());\n        IndexWriter indexWriter = new IndexWriter(directory,new IndexWriterConfig());\n        //indexWriter.deleteAll();\n        indexWriter.deleteDocuments(new Term(\"content\",\"name\"));\n        indexWriter.close();\n```\n\n## 更新\n\n```java\nindexWriter.updateDocument(new Term(\"content\",\"name\"),document);\n```\n\n# QueryParser\n\n","commitList":[{"date":"2021-10-08T12:45:10+08:00","author":"cjiping","message":"doc开发期 构建期调整","hash":"704efe7455b7fb2fbd81ec60099191ff982e639a"},{"date":"2021-10-07T19:38:58+08:00","author":"My","message":"init","hash":"4e0456332231ba0523aa526415f9982377358870"}],"hasMoreCommit":false,"totalCommits":0}