var Q=Object.defineProperty;var X=(e,t,o)=>t in e?Q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o;var C=(e,t,o)=>(X(e,typeof t!="symbol"?t+"":t,o),o);import{d as y,o as a,f as p,b as r,m as Z,r as s,w as d,a as _,t as w,c as g,e as b,F as L,k as A,y as x,z as ee,B as te,E as oe,j as ne,v as se,K as F,C as re,g as H}from"./vendor.db50f025.js";import{a as D}from"./index.6ad25096.js";import{C as ie,a as M,d as v,_ as $,c as ae,D as le}from"./index.9ed97788.js";var S=y({name:"ArrowLeftBold"});const ce={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},de=r("path",{fill:"currentColor",d:"M685.248 104.704a64 64 0 0 1 0 90.496L368.448 512l316.8 316.8a64 64 0 0 1-90.496 90.496L232.704 557.248a64 64 0 0 1 0-90.496l362.048-362.048a64 64 0 0 1 90.496 0z"},null,-1);function ue(e,t,o,i,n,l){return a(),p("svg",ce,[de])}S.render=ue;S.__file="packages/components/ArrowLeftBold.vue";var _e=S,I=y({name:"ArrowRightBold"});const pe={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},he=r("path",{fill:"currentColor",d:"M338.752 104.704a64 64 0 0 0 0 90.496l316.8 316.8-316.8 316.8a64 64 0 0 0 90.496 90.496l362.048-362.048a64 64 0 0 0 0-90.496L429.248 104.704a64 64 0 0 0-90.496 0z"},null,-1);function me(e,t,o,i,n,l){return a(),p("svg",pe,[he])}I.render=me;I.__file="packages/components/ArrowRightBold.vue";var fe=I,ge=Object.defineProperty,ye=Object.getOwnPropertyDescriptor,ve=(e,t,o,i)=>{for(var n=i>1?void 0:i?ye(t,o):t,l=e.length-1,c;l>=0;l--)(c=e[l])&&(n=(i?c(t,o,n):c(n))||n);return i&&n&&ge(t,o,n),n};const we=ie();var B;const P=(B=class{constructor(){}name(){return"category-service"}static getInstance(){return this.instance||(this.instance=new P),this.instance}async getCategoryList(){const e=await D.getCategory(),t=Z(e.content);return[{name:"\u9996\u9875",link:"./README.md",chidren:[]},...this.categoryParse(t)]}categoryParse(e){const o=new DOMParser().parseFromString(e,"text/html").querySelectorAll("body > ul > li"),i=[];for(let n=0;n<o.length;n++)i.push(this.resolveCategory(o[n]));return i}resolveCategory(e){var i,n,l;const t=new M;t.name=(i=e.querySelector("a"))==null?void 0:i.innerText,t.link=(n=e.querySelector("a"))==null?void 0:n.getAttribute("href");const o=(l=e.querySelector("ul"))==null?void 0:l.querySelectorAll(":scope > li");if(!o)return t;for(let c=0;c<o.length;c++){const u=this.resolveCategory(o[c]);u.parent=t,t.chidren.push(u)}return t}},C(B,"instance"),B);let E=P;ve([we],E.prototype,"getCategoryList",1);var R=E.getInstance();function $e(e){return e?(e=e.replace(/[â€™!"#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~]/g,""),e=e.replace(/\n/g,""),e=e.replace(/\t/g,""),e=e.replace(/\s/g,""),e=e.replace(/[\u0060|\u0021-\u002c|\u002e-\u002f|\u003a-\u003f|\u2200-\u22ff|\uFB00-\uFFFD|\u2E80-\u33FF]/g,""),e):""}const Le=y({props:{value:M},data(){return{loading:!0,file:null,lastPastDays:0}},computed:{wordCount(){var e;return $e((e=this.file)==null?void 0:e.content).length}},setup(){},methods:{convert(e){return v.docUrl2Id(e)},async handlePopoverShow(){this.file=await D.getDocFileInfo(this.convert(this.value.link)),this.lastPastDays=this.calcLastUpdate(),this.loading=!1},handlePopoverHide(){this.loading=!0},handleMenuItemClick(e){this.$store.commit("setCurrentCategory",e)},calcLastUpdate(){if(!this.file)return-1;const e=this.file.commitList.map(t=>t.date).map(Date.parse).sort((t,o)=>t-o).reverse()[0];return Math.ceil((new Date().getTime()-e)/(3600*24*1e3))}}});function Ce(e,t,o,i,n,l){const c=s("el-menu-item"),u=s("el-badge"),m=s("el-skeleton"),h=s("el-popover");return a(),p(h,{placement:"right-start",width:200,trigger:"hover","hide-after":100,onShow:e.handlePopoverShow,onHide:e.handlePopoverHide,content:"this is content, this is content, this is content"},{reference:d(()=>[r(c,{index:e.convert(e.value.link),onClick:t[0]||(t[0]=f=>e.handleMenuItemClick(e.value))},{title:d(()=>[_("span",null,w(e.value.name),1)]),_:1},8,["index"])]),default:d(()=>[_("div",null,[r(m,{rows:1,animated:"",loading:e.loading,throttle:500},{default:d(()=>[_("p",null,w(e.value.name),1),r(u,{value:e.lastPastDays+"\u5929\u524D\u66F4\u65B0",class:"item",type:"warning"},null,8,["value"]),r(u,{value:e.wordCount+"\u5B57",class:"item",type:"primary"},null,8,["value"])]),_:1},8,["loading"])])]),_:1},8,["onShow","onHide"])}var ke=$(Le,[["render",Ce]]);const be=y({components:{CategoryItem:ke},props:{menuList:Array},methods:{uuid(){return Math.random().toString()},convert(e){return v.docUrl2Id(e)},childrenSize(e){if(e.chidren.length==0)return 0;let t=e.chidren.length;for(let o of e.chidren)t+=this.childrenSize(o);return t}},setup(){}});function De(e,t,o,i,n,l){const c=s("el-badge"),u=s("category-item"),m=s("category-tree",!0),h=s("el-sub-menu");return a(!0),g(L,null,b(this.menuList,f=>(a(),g(L,null,[f.chidren.length!=0?(a(),p(h,{index:e.convert(f.link)+"p",key:e.convert(f.link)+"p"},{title:d(()=>[_("div",null,[_("span",null,w(f.name),1),r(c,{max:500,value:e.childrenSize(f),class:"item",type:"primary",style:{"margin-left":"8px"}},null,8,["value"])])]),default:d(()=>[r(u,{value:f},null,8,["value"]),r(m,{menuList:f.chidren},null,8,["menuList"])]),_:2},1032,["index"])):(a(),p(u,{value:f,key:e.convert(f.link)},null,8,["value"]))],64))),256)}var Se=$(be,[["render",De],["__scopeId","data-v-77d6df06"]]);const Ie=y({props:{doc:String},components:{CategoryTree:Se},setup(){},data(){return{cateList:[],activeMenu:"",loading:!0}},methods:{handleOpen(e){if(e){console.log(e);const t=e.substring(0,e.length-1);this.showDoc(t)}},showDoc(e){this.updateCurrentCategory(e),this.$router.push("/doc/"+e)},findCategoryById(e){e.split("-");const t=[...this.cateList];for(;t.length>0;){const o=t.pop();if(v.docUrl2Id(o.link)==e)return o;t.push(...o.chidren)}return null},updateCurrentCategory(e){const t=this.findCategoryById(e);t?this.$store.state.currentCategory=t:console.warn(`${this.doc} \u65E0\u6CD5\u627E\u5BFB\u5230\u76F8\u5173\u76EE\u5F55!`)}},async created(){this.loading=!0,this.cateList=await R.getCategoryList(),this.updateCurrentCategory(this.doc),this.$nextTick(()=>{this.loading=!1}),this.loading=!1}});function Be(e,t,o,i,n,l){const c=s("CategoryTree"),u=s("el-menu"),m=s("el-skeleton");return a(),p(m,{rows:24,animated:"",loading:e.loading,throttle:50,style:{"max-width":"80%",padding:"20px"}},{default:d(()=>[r(u,{"unique-opened":"",onOpen:e.handleOpen,"default-active":e.doc,router:!0},{default:d(()=>[r(c,{menuList:e.cateList},null,8,["menuList"])]),_:1},8,["onOpen","default-active"])]),_:1},8,["loading"])}var Te=$(Ie,[["render",Be]]);const Ae=y({props:{contentsList:Array},setup(){}}),Fe=["href"],He={key:0};function Me(e,t,o,i,n,l){const c=s("contents-tree",!0);return a(!0),g(L,null,b(this.contentsList,u=>(a(),g("li",{key:u.link},[_("a",{href:"#"+u.name},w(u.name),9,Fe),u.chidren.length!=0?(a(),g("ul",He,[r(c,{contentsList:u.chidren},null,8,["contentsList"])])):A("",!0)]))),128)}var Pe=$(Ae,[["render",Me]]);function Ee(){document.addEventListener("scroll",e=>{var i;const t=document.querySelectorAll(".markdown-section h1, .markdown-section h2, .markdown-section h3, .markdown-section h4 .markdown-section h5, .markdown-section h6");let o=null;for(let n=0;n<t.length;n++){const l=t[n];l instanceof HTMLElement&&window.scrollY>l.offsetTop-160&&(o=l),window.scrollY==0&&(o=t[0])}if(o!=null){const n=document.querySelector(".toc .active");n!==null&&n.classList.remove("active"),(i=document.querySelector(`.toc a[href='#${o.id}']`))==null||i.classList.add("active")}}),document.addEventListener("scroll",e=>{const t=document.querySelector(".toc"),o=document.querySelector(".toc .active");if(o&&t){const i=t.scrollTop,n=t.scrollTop+t.offsetHeight,l=o.offsetTop;l>n&&t.scrollTo(0,l/2),l<i&&t.scrollTo(0,l/2-i)}})}const Re=y({props:{contentsList:Array},components:{ContentsTree:Pe},created(){Ee()},unmounted(){document.onscroll=null}}),Ue={class:"toc"};function qe(e,t,o,i,n,l){const c=s("contents-tree");return a(),g("ul",Ue,[r(c,{contentsList:e.contentsList},null,8,["contentsList"])])}var ze=$(Re,[["render",qe],["__scopeId","data-v-24d896c4"]]);class U{constructor(){C(this,"content","");C(this,"commitList",[]);C(this,"hasMoreCommit",!1);C(this,"totalCommits",0)}}const Oe=y({props:{file:{type:U,required:!0}},setup(){},data(){return{config:ae}}}),Ve=e=>(x("data-v-5a2fa986"),e=e(),ee(),e),je={class:"block"},Ne=Ve(()=>_("p",{style:{"text-align":"left"}},"\u66F4\u65B0\u5386\u53F2",-1)),We={class:"history-message"},Ye=["href"],Ke={class:"history-message"},Ge={href:"#"};function Je(e,t,o,i,n,l){const c=s("el-timeline-item"),u=s("el-timeline");return a(),g("div",je,[Ne,r(u,null,{default:d(()=>[(a(!0),g(L,null,b(e.file.commitList,(m,h)=>(a(),p(c,{key:h,timestamp:m.date},{default:d(()=>[_("p",We,[_("a",{href:e.config.repositoryUrl+"/commit/"+m.hash,target:"_blank"},w(m.message),9,Ye)])]),_:2},1032,["timestamp"]))),128)),e.file.hasMoreCommit?(a(),p(c,{key:0},{default:d(()=>[_("p",Ke,[_("a",Ge,"\u5168\u90E8\u5386\u53F2("+w(e.file.totalCommits)+"\u6761)",1)])]),_:1})):A("",!0)]),_:1})])}var Qe=$(Oe,[["render",Je],["__scopeId","data-v-5a2fa986"]]);const Xe=y({setup(){},data(){return{showDrawer:!1,readHistoryList:[]}},methods:{docId2Url:le.docId2Url,show(){this.showDrawer=!0,this.readHistoryList=v.getReadHistoryList()},hide(){this.showDrawer=!1}}}),Ze={class:"history-list"},xe=["onClick"];function et(e,t,o,i,n,l){const c=s("el-timeline-item"),u=s("el-timeline"),m=s("el-drawer");return a(),p(m,{modelValue:e.showDrawer,"onUpdate:modelValue":t[0]||(t[0]=h=>e.showDrawer=h),size:"20%",title:"\u9605\u8BFB\u5386\u53F2"},{default:d(()=>[_("div",Ze,[r(u,null,{default:d(()=>[(a(!0),g(L,null,b(e.readHistoryList,h=>(a(),p(c,{key:h.doc,timestamp:h.time},{default:d(()=>[_("a",{href:"#",onClick:te(f=>e.$router.push("/doc/"+h.doc),["prevent"])},w(e.docId2Url(h.doc)),9,xe)]),_:2},1032,["timestamp"]))),128))]),_:1})])]),_:1},8,["modelValue"])}var tt=$(Xe,[["render",et],["__scopeId","data-v-fc74005e"]]);const ot=y({components:{CategoryList:Te,ContentsList:ze,HistoryList:Qe,ReadingHistory:tt,ArrowLeftBold:_e,ArrowRightBold:fe},data(){return{cateList:[],file:new U,contentsList:[],doc:"",loading:!0,showAside:!0}},computed:{contentHtml(){return v.renderMd(this.file.content)},currentCategory(){return this.$store.state.currentCategory},categoryChainList(){return this.currentCategory?this.getCategoryChain(this.currentCategory):[]}},methods:{docUrl2Id(e){return v.docUrl2Id(e)},getCategoryChain(e){const t=[e];for(;e.parent;)t.push(e.parent),e=e.parent;return t.reverse()},async showDoc(e){document.body.scrollTo(0,v.getDocReadRecord(e)),this.loading=!0,this.doc=e;try{this.file=await D.getDocFileInfo(e)}catch(t){oe.error(t.message)}this.generateTOC(),this.$nextTick(()=>{this.registerLinkRouter()}),this.loading=!1},generateTOC(){this.contentsList=v.getContent(this.contentHtml)},registerLinkRouter(){const e=document.querySelectorAll(".markdown-section a");for(let t=0;t<e.length;t++){const o=e[t];o.onclick=i=>{const n=o.getAttribute("href");((n==null?void 0:n.startsWith("doc"))||(n==null?void 0:n.startsWith("/doc")))&&(this.$router.push(n),i.preventDefault())}}},registerScrollListener(){let e;document.addEventListener("scroll",t=>{e=setTimeout(()=>{clearTimeout(e),v.setDocReadRecrod(this.doc,window.scrollY)},1e3)})}},beforeRouteUpdate(e,t){const o=e.params.doc.toString();this.showDoc(o),this.$refs.categoryList.updateCurrentCategory(o)},async created(){this.registerScrollListener(),this.showDoc(this.$route.params.doc.toString()),this.cateList=await R.getCategoryList()},unmounted(){document.onscroll=null}}),nt={class:"category-wrapper"},st=["innerHTML"],rt={style:{"text-align":"center"}},it={class:"footer-wrapper"},at={class:"toc-wrapper"},lt={style:{position:"fixed",right:"160px",top:"60px"}},ct=H("\u9605\u8BFB\u5386\u53F2");function dt(e,t,o,i,n,l){const c=s("category-list"),u=s("el-aside"),m=s("arrow-left-bold"),h=s("arrow-right-bold"),f=s("el-icon"),T=s("el-button"),q=s("el-affix"),z=s("el-breadcrumb-item"),O=s("el-breadcrumb"),V=s("el-divider"),j=s("history-list"),N=s("el-skeleton"),W=s("contents-list"),Y=s("el-main"),K=s("el-container"),G=s("el-backtop"),J=s("reading-history");return a(),g(L,null,[r(K,null,{default:d(()=>[ne(r(u,{width:"280px"},{default:d(()=>[_("div",nt,[(a(),p(F,null,[r(c,{ref:"categoryList",doc:e.doc},null,8,["doc"])],1024))])]),_:1},512),[[se,e.showAside]]),r(q,{offset:384,style:{height:"100px"}},{default:d(()=>[r(T,{class:re(["cate-fix-btn",{active:e.showAside}]),type:"default",size:"mini",onClick:t[0]||(t[0]=k=>e.showAside=!e.showAside)},{default:d(()=>[r(f,null,{default:d(()=>[e.showAside?(a(),p(m,{key:0})):(a(),p(h,{key:1}))]),_:1})]),_:1},8,["class"])]),_:1}),r(Y,{class:"main"},{default:d(()=>[r(N,{rows:25,animated:"",loading:e.loading,throttle:50,style:{"max-width":"80%"}},{default:d(()=>[r(O,{separator:"/"},{default:d(()=>[(a(!0),g(L,null,b(e.categoryChainList,k=>(a(),p(z,{to:{path:"/doc/"+e.docUrl2Id(k.link)},key:k.name},{default:d(()=>[H(w(k.name),1)]),_:2},1032,["to"]))),128))]),_:1}),_("div",{class:"markdown-section",innerHTML:e.contentHtml},null,8,st),_("div",rt,[r(V,{style:{width:"72%"}}),_("div",it,[r(j,{file:e.file},null,8,["file"])])])]),_:1},8,["loading"]),_("div",at,[(a(),p(F,null,[r(W,{contentsList:e.contentsList},null,8,["contentsList"])],1024))]),_("div",lt,[r(T,{onClick:t[1]||(t[1]=k=>e.$refs.readingHistory.show()),type:"primary",size:"mini"},{default:d(()=>[ct]),_:1})])]),_:1})]),_:1}),r(G,{bottom:40,right:366}),r(J,{ref:"readingHistory"},null,512)],64)}var mt=$(ot,[["render",dt],["__scopeId","data-v-2017f0fa"]]);export{mt as default};
