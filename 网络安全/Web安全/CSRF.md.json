{"content":"# 跨站请求伪造（CSRF）\n\n>跨站请求攻击，简单地说，是攻击者通过一些技术手段欺骗用户的浏览器去访问一个自己曾经认证过的网站并运行一些操作（如发邮件，发消息，甚至财产操作如转账和购买商品）\n\n![](https://pic002.cnblogs.com/img/hyddd/200904/2009040916453171.jpg)\n\n## 防御\n\n- 验证码\n  - 发生csrf时，用户一般都不知道，当引入验证码的时候，则就是强制用户与应用交互\n- 检查referer\n  - 页面一般具有逻辑关系，如下单之前的页面一般是购物车，如果不符合条件，则是很可疑的\n- token\n  - 要实施一次csrf，攻击者需要构造出操作的请求数据，如果在这个过程中引入一个随机变量，URL就无法构造，更谈不上攻击了\n\n## 接口幂等性设计\n\n### MVVC 多版本并发控制\n\n通过一个版本号来达到避免冲突，但是会有一定的重试\n\n### 去重表\n\n利用数据库的唯一索引特性，保证唯一的逻辑\n\n### 悲观锁\n\n整个执行过程中锁定该订单对应的记录\n\n### token\n\n数据提交前要向服务的申请 token，token 放到 redis 或内存，token 有效时间提交后后台校验 token，同时删除 token，token只有一次有效性","commitList":[{"date":"2021-10-08T12:45:10+08:00","author":"cjiping","message":"doc开发期 构建期调整","hash":"704efe7455b7fb2fbd81ec60099191ff982e639a"},{"date":"2021-10-07T19:38:58+08:00","author":"My","message":"init","hash":"4e0456332231ba0523aa526415f9982377358870"}],"hasMoreCommit":false,"totalCommits":0}