{"content":"# 扫描\n\n使用扫描来发现目标系统有哪些服务对外监听以及能直接从因特网访问\n\n## ARP主机发现\n\n- 使用arp-scan\n  - arp-scan时在局域网内最合理最快的扫描工具\n\n```shell\nmy@my-PC:~$ sudo arp-scan 192.168.43.0/24\nInterface: wlp3s0, datalink type: EN10MB (Ethernet)\nStarting arp-scan 1.9 with 256 hosts (http://www.nta-monitor.com/tools/arp-scan/)\n192.168.43.1\t82:92:e3:d0:7f:d4\t(Unknown)\n\n1 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.9: 256 hosts scanned in 2.531 seconds (101.15 hosts/sec). 1 responded\n```\n\n- 使用nmap也能同样进行扫描\n\n```shell\nsudo nmap -sn -PR 192.168.43.0/24\n\nStarting Nmap 7.40 ( https://nmap.org ) at 2019-12-09 09:00 CST\nNmap scan report for 192.168.43.1\nHost is up (0.0047s latency).\nMAC Address: 82:92:E3:D0:7F:D4 (Unknown)\nNmap scan report for 192.168.43.242\nHost is up.\nNmap done: 256 IP addresses (2 hosts up) scanned in 3.82 seconds\n```\n\n## ICMP主机发现\n\n>ICMP协议是一种面向无连接的协议，用于传输出错报告控制信息。它是一个非常重要的协议，它对于网络安全具有极其重要的意义\n\n### 响应报文\n\n![](https://upload-images.jianshu.io/upload_images/661949-c12f10903433842a.png?imageMogr2/auto-orient/strip|imageView2/2/w/1200/format/webp)\n\n- 使用ping\n\n- 使用nmap扫描\n\n```shell\nmy@my-PC:~$ sudo nmap -sn -PE zbq.ismy.wang\n\nStarting Nmap 7.40 ( https://nmap.org ) at 2019-12-09 10:04 CST\nNmap scan report for zbq.ismy.wang (120.79.6.172)\nHost is up (0.067s latency).\nNmap done: 1 IP address (1 host up) scanned in 0.43 seconds\n```\n\n- 使用hping\n\n```shell\nmy@my-PC:~$ sudo nping -c 2 --icmp --icmp-type time zbq.ismy.wang\n\nStarting Nping 0.7.40 ( https://nmap.org/nping ) at 2019-12-09 10:07 CST\nSENT (0.0627s) ICMP [192.168.43.242 > 120.79.6.172 Timestamp request (type=13/code=0) id=52393 seq=1 orig=0 recv=0 trans=0] IP [ttl=64 id=34535 iplen=40 ]\nSENT (1.0630s) ICMP [192.168.43.242 > 120.79.6.172 Timestamp request (type=13/code=0) id=52393 seq=2 orig=0 recv=0 trans=0] IP [ttl=64 id=34535 iplen=40 ]\n \nMax rtt: N/A | Min rtt: N/A | Avg rtt: N/A\nRaw packets sent: 2 (80B) | Rcvd: 0 (0B) | Lost: 2 (100.00%)\nNping done: 1 IP address pinged in 2.09 seconds\n```\n\n- windows 下可以使用superScan\n\n## TCP/UDP主机发现\n\n\n- 使用nmap\n\n```shell\nmy@my-PC:~$ nmap -Pn 192.168.43.1\n\nStarting Nmap 7.40 ( https://nmap.org ) at 2019-12-09 10:11 CST\nNmap scan report for 192.168.43.1\nHost is up (0.026s latency).\nNot shown: 999 closed ports\nPORT   STATE SERVICE\n53/tcp open  domain\n\nNmap done: 1 IP address (1 host up) scanned in 0.46 seconds\n\n```\n\n- 只扫描开启特定端口的主机\n\n```shell\nmy@my-PC:~$ sudo nmap -Pn -sS -p 53 192.168.43.0/24\n\nStarting Nmap 7.40 ( https://nmap.org ) at 2019-12-09 10:13 CST\nNmap scan report for 192.168.43.1\nHost is up (0.0079s latency).\nPORT   STATE SERVICE\n53/tcp open  domain\nMAC Address: 82:92:E3:D0:7F:D4 (Unknown)\n\nNmap scan report for 192.168.43.242\nHost is up (0.000052s latency).\nPORT   STATE  SERVICE\n53/tcp closed domain\n\nNmap done: 256 IP addresses (2 hosts up) scanned in 4.36 seconds\n```\n\n- 使用nping\n\n```shell\nmy@my-PC:~$ sudo nping -c 2 --tcp -p 53 --flags syn 192.168.43.1\n\nStarting Nping 0.7.40 ( https://nmap.org/nping ) at 2019-12-09 10:14 CST\nSENT (0.0368s) TCP 192.168.43.242:30555 > 192.168.43.1:53 S ttl=64 id=55281 iplen=40  seq=2174361648 win=1480 \nRCVD (0.2232s) TCP 192.168.43.1:53 > 192.168.43.242:30555 SA ttl=64 id=0 iplen=44  seq=2937135821 win=65535 <mss 1460>\nSENT (1.0373s) TCP 192.168.43.242:30555 > 192.168.43.1:53 S ttl=64 id=55281 iplen=40  seq=2174361648 win=1480 \nRCVD (1.2432s) TCP 192.168.43.1:53 > 192.168.43.242:30555 SA ttl=64 id=0 iplen=44  seq=2952774060 win=65535 <mss 1460>\n \nMax rtt: 205.814ms | Min rtt: 186.441ms | Avg rtt: 196.127ms\nRaw packets sent: 2 (80B) | Rcvd: 2 (88B) | Lost: 0 (0.00%)\nNping done: 1 IP address pinged in 1.28 seconds\n```\n\n### 预防\n\n- 密切留意ping活动\n- 根据需求决定放行哪些ICMP请求\n\n## 端口扫描\n\n>>端口扫描是指某些别有用心的人发送一组端口扫描消息，试图以此侵入某台计算机，并了解其提供的计算机网络服务类型（这些网络服务均与端口号相关）\n\n### sS (TCP SYN扫描)\n\n这种扫描也叫做半开扫描，不会建立一条tcp连接，所以很隐蔽\n\n```shell\nmy@my-PC:~$ sudo nmap -sS 192.168.43.1\n\nStarting Nmap 7.40 ( https://nmap.org ) at 2019-12-09 10:26 CST\nNmap scan report for 192.168.43.1\nHost is up (0.050s latency).\nNot shown: 999 closed ports\nPORT   STATE SERVICE\n53/tcp open  domain\nMAC Address: 82:92:E3:D0:7F:D4 (Unknown)\n\nNmap done: 1 IP address (1 host up) scanned in 1.95 seconds\n```\n\n- 添加Ｄ选项，可以假冒其他源IP发送请求，混杂在扫描请求当中\n\n```shell\nmy@my-PC:~$ sudo nmap -sS 192.168.43.1 -D 10.1.1.1\n\nStarting Nmap 7.40 ( https://nmap.org ) at 2019-12-09 10:33 CST\nNmap scan report for 192.168.43.1\nHost is up (0.062s latency).\nNot shown: 999 closed ports\nPORT   STATE SERVICE\n53/tcp open  domain\nMAC Address: 82:92:E3:D0:7F:D4 (Unknown)\n\nNmap done: 1 IP address (1 host up) scanned in 5.55 seconds\n```\n\n- FTP反弹扫描\n\n它允许用户连接到一台FTP服务器，然后要求文件送到一台第三方服务器。 这个特性在很多层次上被滥用，所以许多服务器已经停止支持它了。其中一种就是导致FTP服务器对其它主机端口扫描。 只要请求FTP服务器轮流发送一个文件到目标主机上的所感兴趣的端口。 错误消息会描述端口是开放还是关闭的。 这是绕过防火墙的好方法\n\n### 使用netcat扫描\n\n```shell\nmy@my-PC:~$ nc -v -z -w2 192.168.43.1 1-140\n192.168.43.1: inverse host lookup failed: Unknown host\n(UNKNOWN) [192.168.43.1] 53 (domain) open\n```\n\n### 预防\n\n- 使用入侵检测系统(IDS)\n- 关闭不必要服务\n\n## 操作系统检测\n\n- 使用nmap -O 选项，探测操作系统类型(主动式探测)\n\n```shell\nmy@my-PC:~$ sudo nmap -O ip\n\nStarting Nmap 7.40 ( https://nmap.org ) at 2019-12-09 16:25 CST\nNmap scan report for zbq.ismy.wang (120.79.6.172)\nHost is up (0.070s latency).\nNot shown: 990 filtered ports\n...\nAggressive OS guesses: Linux 3.10 - 4.2 (91%), Linux 3.2 - 4.6 (90%), Linux 2.6.32 (89%), Linux 3.16 (89%), Linux 4.4 (88%), OpenWrt Kamikaze 7.09 (Linux 2.6.22) (88%), Linux 3.11 - 3.12 (87%), Linux 3.18 (87%), Crestron XPanel control system (87%), HP P2000 G3 NAS device (87%)\nNo exact OS matches for host (test conditions non-ideal).\n\nOS detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 81.44 seconds\n```\n\n\n","commitList":[{"date":"2021-10-08T12:45:10+08:00","author":"cjiping","message":"doc开发期 构建期调整","hash":"704efe7455b7fb2fbd81ec60099191ff982e639a"},{"date":"2021-10-07T19:38:58+08:00","author":"My","message":"init","hash":"4e0456332231ba0523aa526415f9982377358870"}],"hasMoreCommit":false,"totalCommits":0}