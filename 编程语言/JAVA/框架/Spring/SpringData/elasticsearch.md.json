{"content":"# 配置\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<beans xmlns=\"http://www.springframework.org/schema/beans\"\n       xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n       xmlns:jpa=\"http://www.springframework.org/schema/data/jpa\"\n       xmlns:elasticsearch=\"http://www.springframework.org/schema/data/elasticsearch\"\n       xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n     https://www.springframework.org/schema/beans/spring-beans.xsd\n     http://www.springframework.org/schema/data/jpa\n     https://www.springframework.org/schema/data/jpa/spring-jpa.xsd http://www.springframework.org/schema/data/elasticsearch http://www.springframework.org/schema/data/elasticsearch/spring-elasticsearch.xsd\">\n\n    <elasticsearch:transport-client id=\"esClient\" cluster-name=\"docker-elasticsearch\"\n                                    cluster-nodes=\"my-pc:9300\"/>\n    <elasticsearch:repositories base-package=\"wang.ismy.es\"/>\n    <bean id=\"elasticsearchTemplate\" class=\"org.springframework.data.elasticsearch.core.ElasticsearchTemplate\">\n        <constructor-arg name=\"client\" ref=\"esClient\"/>\n    </bean>\n\n</beans>\n```\n\n```java\n@Document(indexName = \"index1\",type = \"article\")\n@Data\npublic class Article {\n\n    @Id\n    @Field(type = FieldType.Long,store = true)\n    private long id;\n\n    @Field(type = FieldType.Text,store = true)\n    private String title;\n\n    @Field(type = FieldType.Text,store = true)\n    private String content;\n\n}\n```\n\n```java\n@Repository\npublic interface ArticleDao extends ElasticsearchRepository<Article,Long> { }\n```\n\n# 创建索引\n\n```java\nElasticsearchTemplate template = context.getBean(ElasticsearchTemplate.class);\ntemplate.createIndex(Article.class);\n```\n\n# 添加文档\n\n```java\n        Article article = new Article();\n        article.setId(1L);\n        article.setTitle(\"【中国稳健前行】“中国之治”的政治保证\");\n        article.setContent(\"新中国成立70年来，在中国共产党的坚强领导下，...\");\n        articleDao.save(article);\n```\n\n# 删除文档\n\n```java\narticleDao.deleteById(1L);\narticleDao.deleteAll(); // 全部删除\n```\n\n# 修改文档\n\n同添加文档\n\n# 查询\n\n- 查询全部\n\n```java\narticleDao.findAll().forEach(System.out::println);\n```\n\n- 根据ID\n\n```java\nSystem.out.println(articleDao.findById(2L).get());\n```\n\n# 自定义查询\n\n```java\n@Repository\npublic interface ArticleDao extends ElasticsearchRepository<Article,Long> {\n\n    List<Article> findAllByTitle(String title);\n}\n```\n\n- 分页查询\n\n```java\nList<Article> findAllByTitle(String title, Pageable pageable);\narticleDao.findAllByTitle(\"中\", PageRequest.of(0,5)).forEach(System.out::println);\n```\n\n- 原生查询\n\n```java\n        NativeSearchQuery query = new NativeSearchQueryBuilder()\n                .withQuery(QueryBuilders.queryStringQuery(\"中国\").defaultField(\"title\"))\n                .withPageable(PageRequest.of(0,5))\n                .build();\n        template.queryForList(query,Article.class).forEach(System.out::println);\n```\n\n\n\n\n\n\n\n\n","commitList":[{"date":"2021-10-08T12:45:10+08:00","author":"cjiping","message":"doc开发期 构建期调整","hash":"704efe7455b7fb2fbd81ec60099191ff982e639a"},{"date":"2021-10-07T19:38:58+08:00","author":"My","message":"init","hash":"4e0456332231ba0523aa526415f9982377358870"}],"hasMoreCommit":false,"totalCommits":0}