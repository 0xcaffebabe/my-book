{"content":"# Shiro\n\n![屏幕截图 2021-09-24 111015](/assets/屏幕截图%202021-09-24%20111015.png)\n\n- Authentication ：身份认证/登录\n- Authorization： ：授权，即权限验证\n\nShiro  不会去维护用户、维护权限\n\n![屏幕截图 2021-09-24 111210](/assets/屏幕截图%202021-09-24%20111210.png)\n\n## 身份验证\n\n```java\nSecurityUtils.setSecurityManager(new IniSecurityManagerFactory(\"classpath:shiro.ini\").getInstance());\nSubject subject = SecurityUtils.getSubject();\nvar token = new UsernamePasswordToken(\"cxk\", \"123\");\ntry {\n    subject.login(token);\n} catch (AuthenticationException e) {\n    // 登录失败\n    e.printStackTrace();\n}\nSystem.out.println(subject.isAuthenticated()); // true\nsubject.logout();\nSystem.out.println(subject.isAuthenticated()); // false\n```\n\n### 认证流程\n\n![屏幕截图 2021-09-24 113925](/assets/屏幕截图%202021-09-24%20113925.png)\n\nRealm：Shiro 从从 Realm 获取安全数据（如用户、角色、权限）\n\n实现org.apache.shiro.realm.Realm接口来自定义自己的用户认证流程\n\n需要注意的是认证完成返回的AuthenticationInfo 这个对象代表用户的信息 权限。\n\nShiro 提供的 Realm：\n\n![屏幕截图 2021-09-24 114623](/assets/屏幕截图%202021-09-24%20114623.png)\n\nAuthenticator 及 AuthenticationStrategy\n\n- Authenticator 的职责是验证用户帐号\n- AuthenticationStrategy 指定了当多个账号符合时 该怎么处理\n\n## 授权\n\n- RBAC\n\n`:表示资源/操作/实例的分割；,表示操作的分割；*表示任意资源/操作/实例`\n\n`*可以匹配所有，不加*可以进行前缀匹配`\n\n### 角色权限判断\n\n```java\nSystem.out.println(subject.hasRole(\"admin\")); // true\nSystem.out.println(subject.isPermitted(\"user:create\")); // true\nSystem.out.println(subject.isPermitted(\"user:delete\")); // false\nsubject.checkPermission(\"user:*\"); // 失败抛异常\n```\n\n### 授权流程\n\n![屏幕截图 2021-09-26 162705](/assets/屏幕截图%202021-09-26%20162705.png)\n\n- Authorizer 是权限判断的接口\n- PermissionResolver 将字符串形式的权限解析成权限对象\n","commitList":[{"date":"2021-10-08T12:45:10+08:00","author":"cjiping","message":"doc开发期 构建期调整","hash":"704efe7455b7fb2fbd81ec60099191ff982e639a"},{"date":"2021-10-07T19:38:58+08:00","author":"My","message":"init","hash":"4e0456332231ba0523aa526415f9982377358870"}],"hasMoreCommit":false,"totalCommits":0}